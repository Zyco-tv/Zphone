<template>
  <div class="phone_app messages">
    <PhoneTitle :title="displayContact" :backgroundColor="color" @back="quit"/>
    <div class="img-fullscreen" v-if="imgZoom !== undefined" @click.stop="imgZoom = undefined">
      <img :src="imgZoom" />
    </div>

    <textarea ref="copyTextarea" class="copyTextarea"/>
    
    <div id='sms_list' @contextmenu.prevent="showOptions">
        <div class="sms" v-bind:class="{ select: key === selectMessage}" v-for='(mess, key) in messagesList' v-bind:key="mess.id"
          @click.stop="onActionMessage(mess)"
        >
            <span class='sms_message sms_me'
              @click.stop="onActionMessage(mess)"
              v-bind:class="{ sms_other : mess.owner === 0}" :style="colorSmsOwner[mess.owner]">
              <img v-if="isSMSImage(mess)" @click.stop="onActionMessage(mess)" class="sms-img" :src="mess.message">
              <span v-else @click.stop="onActionMessage(mess)" >{{mess.message}}</span>
                
                <!-- <span @click.stop="onActionMessage(mess)" ><timeago class="sms_time" :since='mess.time' :auto-update="20" :style="colorSmsOwner[mess.owner]"></timeago></span> -->
            </span>
        </div>
    </div>

    <div id='sms_write' @contextmenu.prevent="showOptions">
        <input
          type="text"
          v-model="message"
          :placeholder="IntlString('APP_MESSAGE_PLACEHOLDER_ENTER_MESSAGE')"
          v-autofocus
          @keyup.enter.prevent="send"
        >
        <div class="sms_send" @click.stop="send">
          <svg height="204" width="204" @click.stop="send" id="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0, 0, 400,228.57142857142858"><g id="svg"><path id="path0" d="M203.411 76.342 C 203.253 76.598,203.470 76.763,203.684 76.549 C 203.804 76.430,203.807 76.336,203.693 76.266 C 203.599 76.208,203.473 76.242,203.411 76.342 M200.599 78.141 C 200.542 78.234,200.576 78.360,200.675 78.422 C 200.931 78.580,201.097 78.363,200.883 78.149 C 200.763 78.030,200.670 78.027,200.599 78.141 M198.766 79.974 C 198.708 80.067,198.742 80.194,198.842 80.255 C 199.098 80.414,199.263 80.197,199.049 79.983 C 198.930 79.863,198.836 79.860,198.766 79.974 M197.833 81.000 C 197.833 81.092,197.946 81.167,198.083 81.167 C 198.221 81.167,198.333 81.092,198.333 81.000 C 198.333 80.908,198.221 80.833,198.083 80.833 C 197.946 80.833,197.833 80.908,197.833 81.000 M197.000 81.917 C 197.000 82.054,197.075 82.167,197.167 82.167 C 197.258 82.167,197.333 82.054,197.333 81.917 C 197.333 81.779,197.258 81.667,197.167 81.667 C 197.075 81.667,197.000 81.779,197.000 81.917 M196.000 82.833 C 196.000 82.925,196.112 83.000,196.250 83.000 C 196.387 83.000,196.500 82.925,196.500 82.833 C 196.500 82.742,196.387 82.667,196.250 82.667 C 196.112 82.667,196.000 82.742,196.000 82.833 M195.167 83.750 C 195.167 83.887,195.242 84.000,195.333 84.000 C 195.425 84.000,195.500 83.887,195.500 83.750 C 195.500 83.612,195.425 83.500,195.333 83.500 C 195.242 83.500,195.167 83.612,195.167 83.750 M194.167 84.667 C 194.167 84.758,194.279 84.833,194.417 84.833 C 194.554 84.833,194.667 84.758,194.667 84.667 C 194.667 84.575,194.554 84.500,194.417 84.500 C 194.279 84.500,194.167 84.575,194.167 84.667 M193.333 85.583 C 193.333 85.721,193.408 85.833,193.500 85.833 C 193.592 85.833,193.667 85.721,193.667 85.583 C 193.667 85.446,193.592 85.333,193.500 85.333 C 193.408 85.333,193.333 85.446,193.333 85.583 M192.333 86.500 C 192.333 86.592,192.446 86.667,192.583 86.667 C 192.721 86.667,192.833 86.592,192.833 86.500 C 192.833 86.408,192.721 86.333,192.583 86.333 C 192.446 86.333,192.333 86.408,192.333 86.500 M191.500 87.417 C 191.500 87.554,191.575 87.667,191.667 87.667 C 191.758 87.667,191.833 87.554,191.833 87.417 C 191.833 87.279,191.758 87.167,191.667 87.167 C 191.575 87.167,191.500 87.279,191.500 87.417 M219.044 89.835 C 218.564 90.292,218.095 90.667,218.002 90.667 C 217.909 90.667,217.833 90.738,217.833 90.825 C 217.833 91.015,214.167 94.667,213.975 94.667 C 213.783 94.667,208.667 99.788,208.667 99.981 C 208.667 100.069,208.142 100.662,207.500 101.299 L 206.333 102.456 206.333 103.747 C 206.333 105.592,208.094 107.104,209.560 106.516 C 209.848 106.401,210.308 106.239,210.583 106.157 C 210.858 106.074,211.646 105.476,212.333 104.828 C 213.021 104.179,213.896 103.371,214.279 103.032 C 214.661 102.694,214.980 102.350,214.987 102.268 C 214.994 102.187,215.412 101.650,215.917 101.076 C 216.421 100.502,216.833 99.959,216.833 99.869 C 216.833 99.609,217.994 98.796,218.235 98.888 C 218.706 99.069,218.685 101.164,218.179 104.333 C 217.900 106.081,217.961 122.517,218.249 123.042 C 218.387 123.294,218.594 123.671,218.708 123.880 C 219.322 124.999,219.746 125.241,221.098 125.241 C 222.483 125.241,222.501 125.230,223.792 123.526 L 224.167 123.031 224.167 113.959 C 224.167 106.760,224.115 104.547,223.918 103.235 C 223.321 99.277,223.982 97.584,225.312 99.665 C 225.715 100.295,227.029 101.909,227.191 101.972 C 227.269 102.003,227.333 102.094,227.333 102.175 C 227.333 102.256,227.652 102.623,228.042 102.991 C 228.431 103.360,229.284 104.168,229.937 104.789 C 231.680 106.444,233.106 106.968,234.230 106.365 C 236.416 105.194,236.670 103.263,234.884 101.391 C 234.373 100.855,233.771 100.176,233.546 99.881 C 232.838 98.955,228.805 94.994,228.308 94.737 C 228.047 94.602,227.833 94.379,227.833 94.240 C 227.833 94.102,227.723 93.947,227.588 93.895 C 227.452 93.843,226.401 92.889,225.251 91.775 C 222.195 88.814,222.473 89.000,221.099 89.002 L 219.917 89.003 219.044 89.835 M189.667 91.083 C 189.667 91.221,189.742 91.333,189.833 91.333 C 189.925 91.333,190.000 91.221,190.000 91.083 C 190.000 90.946,189.925 90.833,189.833 90.833 C 189.742 90.833,189.667 90.946,189.667 91.083 M254.626 99.125 C 254.742 100.204,254.833 100.234,254.833 99.194 C 254.833 98.721,254.768 98.333,254.687 98.333 C 254.607 98.333,254.579 98.690,254.626 99.125 M254.655 115.000 C 254.563 115.919,254.586 116.136,254.759 115.963 C 254.810 115.912,254.828 115.468,254.800 114.977 L 254.747 114.083 254.655 115.000 M249.095 127.262 C 248.770 127.587,248.762 127.683,249.070 127.565 C 249.201 127.515,249.349 127.368,249.399 127.237 C 249.517 126.929,249.420 126.937,249.095 127.262 M241.205 135.167 C 241.091 135.350,241.035 135.500,241.082 135.500 C 241.129 135.500,241.317 135.350,241.500 135.167 C 241.703 134.964,241.751 134.833,241.623 134.833 C 241.508 134.833,241.320 134.983,241.205 135.167 " stroke="none" fill="#f5fbf7" fill-rule="evenod"></path><path id="path1" d="M216.438 73.370 C 216.288 73.611,216.021 73.667,215.013 73.667 C 213.836 73.667,211.934 74.051,211.592 74.358 C 211.505 74.436,211.092 74.500,210.675 74.501 C 210.211 74.501,209.705 74.631,209.371 74.834 C 209.071 75.017,208.673 75.167,208.488 75.167 C 208.062 75.167,207.218 75.596,207.131 75.857 C 207.095 75.965,206.957 76.072,206.824 76.095 C 205.885 76.252,205.579 76.348,205.528 76.500 C 205.450 76.733,204.339 77.190,204.145 77.070 C 204.061 77.018,204.012 77.071,204.038 77.188 C 204.063 77.306,203.994 77.405,203.885 77.409 C 203.775 77.413,203.524 77.591,203.326 77.803 C 203.128 78.015,202.864 78.150,202.738 78.102 C 202.613 78.054,202.459 78.098,202.396 78.200 C 202.323 78.318,202.366 78.341,202.516 78.263 C 202.645 78.197,202.604 78.260,202.426 78.404 C 202.249 78.549,202.024 78.668,201.926 78.670 C 201.829 78.671,201.573 78.859,201.358 79.086 C 201.142 79.314,200.823 79.500,200.649 79.500 C 200.474 79.500,200.333 79.616,200.333 79.760 C 200.333 79.903,200.267 79.979,200.185 79.928 C 200.104 79.878,200.048 79.930,200.060 80.043 C 200.073 80.157,200.021 80.264,199.946 80.281 C 199.870 80.298,199.642 80.504,199.440 80.739 C 199.238 80.974,199.013 81.167,198.941 81.167 C 198.753 81.167,195.333 84.651,195.333 84.842 C 195.333 84.929,195.243 84.981,195.133 84.958 C 195.022 84.935,194.928 85.004,194.924 85.111 C 194.914 85.362,194.692 85.582,194.444 85.587 C 194.338 85.589,194.272 85.720,194.299 85.879 C 194.332 86.076,194.237 86.167,193.997 86.167 C 193.805 86.167,193.688 86.232,193.737 86.312 C 193.787 86.392,193.641 86.659,193.414 86.904 C 193.186 87.150,193.000 87.426,193.000 87.518 C 193.000 87.611,192.925 87.640,192.833 87.583 C 192.739 87.525,192.667 87.662,192.667 87.897 C 192.667 88.127,192.522 88.416,192.345 88.540 C 192.168 88.664,191.999 88.875,191.970 89.008 C 191.940 89.141,191.748 89.489,191.542 89.781 C 191.335 90.072,191.167 90.411,191.167 90.532 C 191.167 90.654,191.017 90.847,190.833 90.961 C 190.650 91.076,190.500 91.281,190.500 91.418 C 190.500 91.555,190.438 91.667,190.361 91.667 C 190.285 91.667,190.210 91.779,190.194 91.917 C 190.179 92.054,190.154 92.279,190.139 92.417 C 190.124 92.554,190.049 92.667,189.972 92.667 C 189.896 92.667,189.849 92.723,189.868 92.792 C 189.886 92.860,189.774 93.157,189.618 93.450 C 189.461 93.743,189.333 94.133,189.333 94.317 C 189.333 94.500,189.211 94.719,189.060 94.803 C 188.887 94.900,188.759 95.252,188.708 95.769 C 188.665 96.217,188.562 96.608,188.481 96.639 C 188.400 96.669,188.331 96.894,188.328 97.139 C 188.325 97.383,188.177 97.883,188.000 98.250 C 187.756 98.754,187.677 99.284,187.672 100.427 C 187.668 101.684,187.613 101.995,187.344 102.283 C 186.880 102.781,186.819 110.420,187.272 111.328 C 187.452 111.687,187.597 112.540,187.670 113.656 C 187.787 115.447,187.997 116.275,188.414 116.595 C 188.561 116.707,188.661 117.156,188.684 117.810 C 188.705 118.381,188.796 118.894,188.887 118.950 C 188.984 119.010,189.002 118.955,188.930 118.817 C 188.863 118.689,188.917 118.716,189.050 118.878 C 189.183 119.040,189.340 119.538,189.399 119.984 C 189.481 120.601,189.586 120.817,189.837 120.882 C 190.061 120.941,190.167 121.110,190.167 121.412 C 190.167 121.887,190.408 122.432,190.786 122.810 C 190.914 122.938,190.980 123.146,190.931 123.271 C 190.883 123.397,190.916 123.500,191.005 123.500 C 191.094 123.500,191.167 123.655,191.167 123.844 C 191.167 124.034,191.354 124.435,191.583 124.735 C 191.813 125.036,192.000 125.350,192.000 125.434 C 192.000 125.518,192.150 125.680,192.333 125.795 C 192.517 125.909,192.667 126.164,192.667 126.360 C 192.667 126.557,192.948 126.991,193.292 127.325 C 193.635 127.658,194.404 128.488,195.000 129.168 C 195.596 129.848,196.402 130.715,196.792 131.094 C 197.181 131.473,197.500 131.861,197.500 131.957 C 197.500 132.052,197.688 132.178,197.917 132.235 C 198.146 132.293,198.333 132.451,198.333 132.587 C 198.333 132.722,198.435 132.833,198.559 132.833 C 198.787 132.833,199.291 133.265,199.934 134.010 C 200.127 134.234,200.496 134.567,200.754 134.750 C 201.011 134.933,201.303 135.163,201.403 135.260 C 201.502 135.357,201.996 135.656,202.500 135.925 C 203.004 136.194,203.480 136.514,203.556 136.635 C 203.687 136.842,206.317 138.162,206.615 138.170 C 206.689 138.172,206.938 138.321,207.167 138.500 C 207.396 138.679,207.789 138.828,208.040 138.830 C 208.291 138.832,208.649 138.965,208.837 139.125 C 209.024 139.285,209.231 139.423,209.297 139.431 C 209.363 139.438,209.628 139.532,209.886 139.639 C 210.144 139.746,210.700 139.833,211.123 139.833 C 211.620 139.833,212.004 139.936,212.212 140.125 C 212.468 140.357,212.881 140.424,214.225 140.450 C 215.332 140.472,215.773 140.435,215.500 140.342 C 215.153 140.224,215.139 140.198,215.417 140.186 C 215.600 140.178,215.862 140.244,216.000 140.333 C 216.137 140.422,216.194 140.496,216.126 140.497 C 216.058 140.499,216.151 140.672,216.334 140.882 C 216.912 141.546,225.456 141.521,226.123 140.852 
          C 226.318 140.657,226.831 140.559,227.988 140.495 C 229.010 140.438,229.787 140.304,230.151 140.120 C 230.463 139.962,230.960 139.833,231.255 139.833 C 231.551 139.833,232.064 139.720,232.396 139.581 C 232.728 139.442,233.000 139.379,233.000 139.440 C 233.000 139.501,233.140 139.390,233.311 139.192 C 233.488 138.989,233.819 138.833,234.077 138.833 C 234.327 138.833,234.731 138.694,234.974 138.523 C 235.218 138.352,235.717 138.110,236.083 137.986 C 236.450 137.862,236.878 137.634,237.034 137.478 C 237.191 137.323,237.551 137.145,237.834 137.083 C 238.117 137.021,238.439 136.827,238.548 136.652 C 238.657 136.477,238.828 136.333,238.927 136.333 C 239.026 136.333,239.402 136.110,239.762 135.838 C 240.122 135.566,240.481 135.341,240.559 135.338 C 240.638 135.335,240.850 135.146,241.030 134.917 C 241.210 134.687,241.464 134.500,241.594 134.500 C 241.724 134.500,241.924 134.350,242.039 134.167 C 242.153 133.983,242.338 133.833,242.448 133.833 C 242.559 133.833,242.710 133.729,242.783 133.602 C 242.857 133.475,243.254 133.092,243.667 132.752 C 244.721 131.882,246.174 130.462,246.667 129.821 C 246.896 129.522,247.252 129.113,247.458 128.912 C 247.665 128.710,247.833 128.469,247.833 128.375 C 247.833 128.282,248.021 128.082,248.250 127.932 C 248.479 127.782,248.669 127.567,248.671 127.454 C 248.674 127.342,248.897 127.033,249.167 126.768 C 249.437 126.504,249.624 126.233,249.584 126.168 C 249.543 126.102,249.695 125.874,249.922 125.662 C 250.148 125.449,250.333 125.179,250.333 125.062 C 250.333 124.945,250.521 124.661,250.750 124.432 C 250.979 124.203,251.167 123.876,251.167 123.707 C 251.167 123.537,251.354 123.144,251.583 122.833 C 251.813 122.523,252.000 122.138,252.000 121.977 C 252.000 121.817,252.076 121.639,252.169 121.582 C 252.403 121.437,253.043 120.154,252.935 120.047 C 252.887 119.998,253.010 119.649,253.208 119.271 C 253.406 118.893,253.575 118.546,253.584 118.500 C 253.593 118.454,253.658 118.042,253.729 117.583 C 253.801 117.125,253.963 116.589,254.089 116.392 C 254.215 116.195,254.396 115.445,254.491 114.725 C 254.586 114.006,254.780 112.929,254.923 112.333 C 255.249 110.971,255.445 108.244,255.207 108.392 C 255.114 108.449,254.993 108.328,254.938 108.123 C 254.772 107.504,254.819 105.500,255.000 105.500 C 255.097 105.500,255.167 106.056,255.167 106.833 C 255.167 107.567,255.225 108.167,255.297 108.167 C 255.369 108.167,255.405 107.023,255.377 105.625 C 255.314 102.455,255.287 102.110,255.096 101.972 C 255.011 101.911,254.849 101.199,254.736 100.389 C 254.433 98.220,254.365 97.935,254.100 97.742 C 253.953 97.634,253.814 97.102,253.742 96.367 C 253.667 95.606,253.518 95.046,253.333 94.833 C 253.173 94.649,252.996 94.208,252.939 93.854 C 252.883 93.500,252.723 93.116,252.585 93.001 C 252.447 92.886,252.333 92.666,252.333 92.512 C 252.333 92.358,251.961 91.659,251.506 90.959 C 251.052 90.259,250.574 89.439,250.445 89.135 C 250.316 88.832,250.013 88.373,249.772 88.116 C 249.531 87.860,249.333 87.597,249.332 87.533 C 249.330 87.369,247.674 85.445,247.396 85.283 C 247.270 85.210,247.167 85.044,247.167 84.914 C 247.167 84.689,246.280 83.667,246.085 83.667 C 246.034 83.667,245.154 82.842,244.129 81.833 C 243.105 80.825,242.207 80.000,242.133 80.000 C 242.060 80.000,242.000 79.887,242.000 79.750 C 242.000 79.612,241.897 79.500,241.770 79.500 C 241.644 79.500,241.438 79.376,241.312 79.224 C 241.186 79.072,240.840 78.846,240.542 78.722 C 240.244 78.597,240.000 78.426,240.000 78.342 C 240.000 78.257,239.736 78.093,239.413 77.976 C 239.090 77.859,238.713 77.592,238.576 77.382 C 238.438 77.172,238.182 77.000,238.006 77.000 C 237.830 77.000,237.639 76.924,237.582 76.831 C 237.524 76.737,237.415 76.700,237.339 76.746 C 237.264 76.793,237.160 76.723,237.110 76.592 C 237.059 76.460,236.751 76.302,236.425 76.241 C 236.099 76.179,235.560 75.913,235.227 75.648 C 234.857 75.354,234.419 75.165,234.102 75.163 C 233.817 75.161,233.396 75.013,233.167 74.833 C 232.894 74.620,232.487 74.506,231.990 74.504 C 231.542 74.502,230.925 74.347,230.490 74.129 C 229.901 73.833,229.393 73.745,228.004 73.696 C 226.520 73.643,226.225 73.587,226.037 73.317 C 225.743 72.898,223.131 72.845,222.726 73.250 C 222.377 73.599,220.615 73.592,220.264 73.240 C 219.866 72.842,216.701 72.950,216.438 73.370 M231.500 74.836 C 231.676 74.951,231.577 74.968,231.167 74.892 C 230.448 74.761,230.312 74.666,230.847 74.669 C 231.069 74.671,231.362 74.746,231.500 74.836 M245.250 83.833 C 245.608 84.200,245.863 84.500,245.818 84.500 C 245.772 84.500,245.441 84.200,245.083 83.833 C 244.725 83.467,244.470 83.167,244.516 83.167 C 244.562 83.167,244.892 83.467,245.250 83.833 M223.193 89.524 C 223.683 89.904,224.986 91.085,226.090 92.149 C 228.544 94.514,229.832 95.667,230.023 95.667 C 230.102 95.667,230.167 95.761,230.167 95.876 C 230.167 95.991,230.501 96.347,230.909 96.667 C 231.317 96.988,231.725 97.456,231.817 97.708 C 231.908 97.960,232.070 98.167,232.178 98.167 C 232.386 98.167,232.899 98.682,234.750 100.749 C 236.028 102.177,236.271 102.871,236.069 104.523 C 235.877 106.086,233.023 107.615,232.183 106.603 C 232.078 106.477,231.764 106.328,231.485 106.272 C 230.924 106.160,227.571 103.069,226.750 101.907 C 226.567 101.648,226.243 101.282,226.031 101.095 C 225.819 100.908,225.494 100.510,225.309 100.211 C 224.975 99.670,224.613 99.516,224.418 99.831 C 224.362 99.922,224.322 105.249,224.329 111.669 L 224.341 123.343 223.629 124.250 C 222.801 125.305,222.513 125.424,220.853 125.395 C 219.645 125.374,218.667 124.842,218.667 124.205 C 218.667 124.124,218.475 123.878,218.241 123.658 L 217.815 123.258 217.834 111.921 C 217.844 105.685,217.848 100.415,217.843 100.208 C 217.832 99.788,217.000 99.638,217.000 100.057 C 217.000 100.179,216.588 100.723,216.085 101.265 C 215.581 101.807,215.126 102.381,215.074 102.542 C 215.021 102.702,214.888 102.833,214.778 102.833 C 214.669 102.833,214.505 103.001,214.415 103.205 C 214.324 103.410,214.100 103.654,213.917 103.747 C 213.381 104.020,212.667 104.708,212.667 104.951 C 212.667 105.074,212.477 105.247,212.246 105.335 C 212.014 105.423,211.785 105.598,211.737 105.724 C 211.689 105.849,211.352 106.050,210.989 106.170 C 210.626 106.290,210.245 106.488,210.144 106.611 C 209.661 107.193,208.127 106.890,207.157 106.021 L 206.250 105.208 206.258 103.620 L 206.266 102.031 207.550 100.735 C 208.256 100.022,208.833 99.338,208.833 99.215 C 208.833 99.092,209.011 98.924,209.227 98.842 C 209.444 98.760,209.667 98.574,209.722 98.429 C 209.777 98.285,209.938 98.167,210.078 98.167 C 210.218 98.167,210.333 98.053,210.333 97.915 C 210.333 97.656,212.280 95.667,212.533 95.667 C 212.610 95.667,212.759 95.481,212.862 95.253 C 212.966 95.026,213.182 94.798,213.343 94.747 C 213.503 94.696,214.622 93.701,215.828 92.536 C 219.737 88.759,219.631 88.833,221.070 88.833 C 222.262 88.833,222.333 88.857,223.193 89.524 M254.282 100.625 C 254.240 100.785,254.205 100.654,254.205 100.333 C 254.205 100.013,254.240 99.881,254.282 100.042 C 254.323 100.202,254.323 100.465,254.282 100.625 M254.901 103.750 C 254.980 104.073,254.967 104.191,254.862 104.083 C 254.774 103.992,254.657 103.579,254.604 103.167 C 254.506 102.413,254.638 102.670,254.901 103.750 M255.030 109.648 C 254.938 109.705,254.830 109.976,254.790 110.251 L 254.717 110.750 254.692 110.218 C 254.678 109.926,254.742 109.640,254.833 109.583 C 254.925 109.527,255.010 109.316,255.023 109.115 C 255.044 108.773,255.050 108.776,255.121 109.148 C 255.162 109.367,255.121 109.592,255.030 109.648 M254.282 113.958 C 254.240 114.119,254.205 113.987,254.205 113.667 C 254.205 113.346,254.240 113.215,254.282 113.375 C 254.323 113.535,254.323 113.798,254.282 113.958 M252.667 119.718 C 252.667 119.838,252.556 120.082,252.422 120.260 C 252.200 120.552,252.196 120.531,252.375 120.042 C 252.588 119.460,252.667 119.372,252.667 119.718 M251.934 121.193 C 251.631 121.625,251.575 121.483,251.847 120.975 C 251.946 120.790,252.066 120.677,252.114 120.725 C 252.162 120.773,252.081 120.983,251.934 121.193 M248.843 126.380 C 248.629 126.583,248.517 126.638,248.595 126.500 C 248.805 126.126,249.074 125.858,249.157 125.938 C 249.198 125.977,249.057 126.176,248.843 126.380 M195.250 128.333 C 195.392 128.608,195.471 128.833,195.425 128.833 C 195.379 128.833,195.226 128.608,195.083 128.333 C 194.941 128.058,194.862 127.833,194.908 127.833 C 194.954 127.833,195.108 128.058,195.250 128.333 M246.555 129.076 C 246.302 129.392,246.061 129.616,246.018 129.574 C 245.947 129.502,246.821 128.500,246.955 128.500 C 246.988 128.500,246.808 128.759,246.555 129.076 M196.260 129.445 C 196.517 129.782,196.642 130.004,196.538 129.940 C 196.325 129.808,195.603 128.833,195.719 128.833 C 195.760 128.833,196.004 129.109,196.260 129.445 M244.833 130.833 C 244.543 131.200,244.268 131.500,244.222 131.500 C 244.176 131.500,244.376 131.200,244.667 130.833 C 244.957 130.467,245.232 130.167,245.278 130.167 C 245.324 130.167,245.124 130.467,244.833 130.833 M242.778 132.754 C 242.060 133.439,241.423 134.000,241.362 134.000 C 241.302 134.000,241.849 133.438,242.578 132.750 C 243.307 132.063,243.944 131.502,243.993 131.504 C 244.043 131.506,243.496 132.068,242.778 132.754 M199.569 132.651 C 200.038 133.169,199.807 133.073,199.155 132.479 C 198.841 132.193,198.734 132.036,198.919 132.130 C 199.103 132.225,199.396 132.459,199.569 132.651 M241.167 134.079 C 241.167 134.123,240.942 134.274,240.667 134.417 C 240.040 134.741,240.002 134.600,240.625 134.262 C 241.149 133.978,241.167 133.972,241.167 134.079 M202.251 134.668 C 202.417 134.852,202.522 135.034,202.483 135.072 C 202.444 135.111,202.251 134.961,202.052 134.738 C 201.854 134.515,201.750 134.333,201.820 134.333 C 201.891 134.333,202.085 134.484,202.251 134.668 M234.833 138.009 C 234.399 138.305,233.667 138.678,233.667 138.604 C 233.667 138.491,234.732 137.839,234.917 137.839 C 235.008 137.839,234.971 137.915,234.833 138.009 M231.833 139.154 C 231.220 139.339,229.914 139.531,230.025 139.420 C 230.139 139.305,231.445 139.038,231.917 139.033 C 
          232.172 139.030,232.153 139.058,231.833 139.154 M211.833 139.333 C 212.165 139.547,211.748 139.547,211.250 139.333 L 210.917 139.190 211.250 139.181 C 211.433 139.176,211.696 139.244,211.833 139.333 M226.792 140.282 C 226.631 140.323,226.369 140.323,226.208 140.282 C 226.048 140.240,226.179 140.205,226.500 140.205 C 226.821 140.205,226.952 140.240,226.792 140.282 M223.250 141.000 C 223.067 141.079,222.092 141.134,221.083 141.122 L 219.250 141.100 221.167 141.000 C 222.221 140.945,223.196 140.890,223.333 140.878 C 223.471 140.866,223.433 140.921,223.250 141.000 " stroke="none" fill="#0484fb" fill-rule="evenod"></path><path id="path2" d="M212.083 73.833 C 212.027 73.925,212.093 74.000,212.230 74.000 C 212.368 74.000,212.527 73.925,212.583 73.833 C 212.640 73.742,212.574 73.667,212.436 73.667 C 212.299 73.667,212.140 73.742,212.083 73.833 M229.514 73.727 C 229.710 73.896,230.518 73.997,230.421 73.840 C 230.362 73.745,230.118 73.667,229.879 73.667 C 229.640 73.667,229.476 73.694,229.514 73.727 M206.931 75.528 C 206.773 75.713,206.691 75.914,206.751 75.973 C 206.810 76.032,206.931 75.950,207.021 75.790 C 207.110 75.631,207.288 75.500,207.415 75.500 C 207.764 75.500,207.855 75.239,207.515 75.214 C 207.352 75.201,207.090 75.343,206.931 75.528 M238.500 77.125 C 238.500 77.205,238.609 77.415,238.742 77.593 C 238.975 77.905,238.980 77.903,238.888 77.539 C 238.793 77.163,238.500 76.850,238.500 77.125 M249.341 87.511 C 249.540 87.790,249.751 87.967,249.810 87.903 C 249.869 87.840,249.823 87.754,249.708 87.713 C 249.594 87.672,249.500 87.541,249.500 87.421 C 249.500 87.301,249.383 87.157,249.240 87.102 C 249.046 87.028,249.071 87.132,249.341 87.511 M221.167 88.986 C 222.033 89.053,222.521 89.176,222.751 89.384 C 222.934 89.549,224.041 90.610,225.213 91.742 C 226.384 92.875,227.452 93.843,227.588 93.895 C 227.723 93.947,227.833 94.102,227.833 94.240 C 227.833 94.379,228.047 94.602,228.308 94.737 C 228.805 94.994,232.838 98.955,233.546 99.881 C 233.771 100.176,234.373 100.855,234.885 101.391 C 235.396 101.927,235.846 102.527,235.885 102.725 C 235.924 102.922,235.931 102.824,235.900 102.508 C 235.858 102.079,235.651 101.753,235.088 101.229 C 234.673 100.843,234.333 100.479,234.333 100.422 C 234.333 100.365,234.165 100.144,233.958 99.930 C 233.752 99.717,233.465 99.401,233.320 99.229 C 233.175 99.057,232.781 98.692,232.445 98.418 C 232.108 98.143,231.833 97.862,231.833 97.793 C 231.833 97.660,229.278 95.107,228.810 94.773 C 228.597 94.621,225.138 91.390,223.699 90.000 C 222.631 88.968,222.323 88.833,221.102 88.861 L 219.917 88.889 221.167 88.986 M218.793 89.801 C 218.311 90.242,217.111 91.377,216.125 92.325 C 215.140 93.272,214.127 94.206,213.875 94.400 C 213.461 94.719,210.681 97.489,210.233 98.029 C 210.133 98.151,209.795 98.487,209.483 98.776 C 209.172 99.065,208.542 99.723,208.083 100.237 C 207.625 100.751,207.044 101.395,206.792 101.668 C 205.848 102.688,206.378 102.413,207.500 101.299 C 208.142 100.662,208.667 100.069,208.667 99.981 C 208.667 99.788,213.783 94.667,213.975 94.667 C 214.167 94.667,217.833 91.015,217.833 90.825 C 217.833 90.738,217.909 90.667,218.002 90.667 C 218.095 90.667,218.564 90.292,219.044 89.835 C 220.162 88.770,219.953 88.742,218.793 89.801 M251.031 90.084 C 251.135 90.314,251.243 90.479,251.270 90.452 C 251.372 90.350,251.123 89.667,250.984 89.667 C 250.905 89.667,250.926 89.854,251.031 90.084 M252.333 92.413 C 252.333 92.456,252.483 92.738,252.666 93.038 C 252.887 93.400,252.999 93.485,252.999 93.292 C 253.000 93.131,252.850 92.850,252.667 92.667 C 252.483 92.483,252.333 92.369,252.333 92.413 M217.373 99.294 C 217.075 99.545,216.831 99.821,216.832 99.909 C 216.833 99.996,216.594 100.315,216.301 100.617 C 216.008 100.919,215.851 101.167,215.952 101.167 C 216.054 101.167,216.332 100.923,216.571 100.625 C 216.810 100.327,217.086 99.986,217.184 99.866 C 217.903 98.994,218.182 100.231,217.988 103.431 C 217.893 104.982,217.839 110.075,217.867 114.750 L 217.917 123.250 218.643 124.167 C 219.373 125.087,219.883 125.508,219.473 124.851 C 219.352 124.658,219.202 124.500,219.139 124.500 C 219.076 124.500,218.917 124.294,218.785 124.042 C 218.653 123.790,218.422 123.358,218.271 123.083 C 217.963 122.520,217.883 106.191,218.179 104.333 C 218.914 99.732,218.670 98.204,217.373 99.294 M223.867 99.033 C 223.591 99.309,223.615 101.225,223.918 103.235 C 224.115 104.547,224.167 106.760,224.167 113.959 L 224.167 123.031 223.792 123.521 C 222.603 125.077,222.523 125.140,221.568 125.259 C 221.064 125.322,220.688 125.410,220.732 125.454 C 221.169 125.892,223.667 124.723,223.667 124.080 C 223.667 123.985,223.824 123.773,224.017 123.608 L 224.367 123.308 224.311 111.529 L 224.255 99.750 224.712 99.697 C 225.032 99.660,225.202 99.735,225.282 99.947 C 225.392 100.242,226.728 101.871,227.433 102.570 C 227.625 102.761,227.872 103.085,227.981 103.292 C 228.089 103.498,228.267 103.667,228.374 103.667 C 228.482 103.667,229.064 104.182,229.668 104.811 C 230.272 105.441,230.950 106.014,231.175 106.085 C 231.400 106.155,231.845 106.353,232.164 106.523 C 232.920 106.927,233.757 106.917,234.288 106.500 C 234.770 106.120,234.588 106.047,234.093 106.422 C 233.293 107.027,231.588 106.357,229.937 104.789 C 229.284 104.168,228.431 103.360,228.042 102.991 C 227.652 102.623,227.333 102.250,227.333 102.161 C 227.333 102.072,227.277 101.999,227.208 101.998 C 227.140 101.998,226.708 101.498,226.250 100.889 C 224.816 98.981,224.312 98.588,223.867 99.033 M215.362 101.719 C 214.947 102.162,214.872 102.481,215.259 102.159 C 215.512 101.949,215.904 101.333,215.785 101.333 C 215.752 101.333,215.562 101.507,215.362 101.719 M206.214 103.750 C 206.216 104.208,206.248 104.376,206.286 104.123 C 206.325 103.869,206.324 103.494,206.284 103.289 C 206.244 103.084,206.213 103.292,206.214 103.750 M213.469 103.754 C 213.041 104.065,212.630 104.424,212.554 104.553 C 212.479 104.682,212.056 105.098,211.615 105.477 C 211.174 105.856,210.890 106.167,210.984 106.167 C 211.197 106.167,212.188 105.309,213.053 104.375 C 213.414 103.985,213.808 103.667,213.928 103.667 C 214.048 103.667,214.196 103.587,214.257 103.489 C 214.485 103.120,214.221 103.209,213.469 103.754 M236.039 104.000 C 236.039 104.321,236.073 104.452,236.115 104.292 C 236.157 104.131,236.157 103.869,236.115 103.708 C 236.073 103.548,236.039 103.679,236.039 104.000 M206.750 105.613 C 207.982 106.840,209.571 107.197,210.309 106.412 C 210.610 106.091,210.637 106.086,209.477 106.550 C 208.951 106.760,207.630 106.326,207.188 105.799 C 207.039 105.621,206.767 105.394,206.583 105.295 C 206.375 105.182,206.438 105.302,206.750 105.613 M235.154 105.792 L 234.750 106.250 235.250 105.833 C 235.525 105.604,235.781 105.398,235.819 105.375 C 235.858 105.352,235.814 105.333,235.723 105.333 C 235.633 105.333,235.376 105.540,235.154 105.792 M255.294 110.000 C 255.241 111.110,255.124 111.934,254.996 112.088 C 254.881 112.227,254.823 112.379,254.869 112.425 C 254.915 112.471,255.053 112.388,255.175 112.240 C 255.386 111.986,255.654 108.167,255.461 108.167 C 255.417 108.167,255.341 108.992,255.294 110.000 M187.000 111.833 C 187.000 112.159,187.084 112.333,187.241 112.333 C 187.437 112.333,187.450 112.239,187.308 111.833 C 187.212 111.558,187.104 111.333,187.067 111.333 C 187.030 111.333,187.000 111.558,187.000 111.833 M254.705 113.667 C 254.705 113.987,254.740 114.119,254.782 113.958 C 254.823 113.798,254.823 113.535,254.782 113.375 C 254.740 113.215,254.705 113.346,254.705 113.667 M254.542 115.083 C 254.544 115.450,254.578 115.580,254.618 115.373 C 254.658 115.166,254.656 114.866,254.615 114.706 C 254.573 114.547,254.540 114.717,254.542 115.083 M252.458 121.250 C 252.206 121.641,252.000 122.071,252.000 122.207 C 252.000 122.344,251.843 122.655,251.650 122.900 C 251.427 123.183,251.382 123.327,251.525 123.297 C 251.841 123.231,252.175 122.742,252.272 122.205 C 252.317 121.955,252.506 121.588,252.692 121.390 C 252.878 121.192,253.005 120.920,252.973 120.785 C 252.938 120.634,252.742 120.812,252.458 121.250 M190.167 122.612 C 190.167 122.825,190.806 123.416,190.917 123.305 C 190.962 123.260,190.811 123.048,190.583 122.833 C 190.354 122.618,190.167 122.518,190.167 122.612 M250.731 124.528 C 250.417 124.881,250.418 124.881,250.833 124.668 C 251.376 124.390,251.382 124.383,251.200 124.271 C 251.115 124.218,250.903 124.334,250.731 124.528 M249.872 125.823 C 249.576 126.276,249.333 126.708,249.333 126.783 C 249.333 126.858,249.183 127.013,249.000 127.128 C 248.817 127.242,248.667 127.435,248.667 127.557 C 248.667 127.678,248.498 127.868,248.292 127.978 C 248.085 128.089,247.822 128.383,247.707 128.631 C 247.556 128.956,247.711 128.849,248.256 128.250 C 248.674 127.792,249.125 127.298,249.258 127.153 C 249.391 127.007,249.500 126.797,249.500 126.685 C 249.500 126.572,249.575 126.527,249.667 126.583 C 249.758 126.640,249.833 126.541,249.833 126.364 C 249.833 126.186,249.950 125.944,250.092 125.826 C 250.418 125.555,250.723 125.000,250.545 125.000 C 250.471 125.000,250.169 125.370,249.872 125.823 M243.206 133.111 C 243.091 133.158,242.912 133.358,242.809 133.556 C 242.633 133.894,242.650 133.891,243.061 133.513 C 243.302 133.290,243.500 133.084,243.500 133.054 C 243.500 132.993,243.497 132.994,243.206 133.111 M242.102 134.245 C 241.950 134.477,241.728 134.667,241.609 134.667 C 241.489 134.667,241.215 134.854,241.000 135.083 C 240.785 135.313,240.692 135.500,240.795 135.500 C 240.897 135.500,241.079 135.361,241.199 135.191 C 241.319 135.020,241.567 134.834,241.750 134.776 C 241.934 134.718,242.183 134.512,242.304 134.319 C 242.620 133.812,242.431 133.742,242.102 134.245 M239.523 136.006 C 239.262 136.223,239.211 136.333,239.372 136.333 C 239.506 136.333,239.751 136.183,239.917 136.000 C 240.303 135.573,240.038 135.577,239.523 136.006 M237.050 137.559 C 236.977 137.683,236.692 137.865,236.417 137.962 C 236.037 138.098,235.999 138.144,236.259 138.154 C 236.448 138.161,236.856 137.979,237.167 137.750 C 237.531 137.481,237.634 137.333,237.457 137.333 C 237.307 137.333,237.123 137.435,237.050 137.559 M206.744 138.493 C 206.913 
          138.680,207.171 138.825,207.317 138.814 C 207.534 138.798,207.529 138.780,207.292 138.718 C 207.131 138.677,207.000 138.581,207.000 138.506 C 207.000 138.430,206.873 138.320,206.718 138.261 C 206.470 138.166,206.473 138.194,206.744 138.493 M235.217 138.392 C 235.143 138.516,234.971 138.660,234.833 138.712 C 234.658 138.779,234.688 138.811,234.933 138.820 C 235.125 138.827,235.417 138.683,235.583 138.500 C 235.847 138.208,235.852 138.167,235.617 138.167 C 235.470 138.167,235.290 138.268,235.217 138.392 M229.583 140.333 C 229.262 140.471,229.263 140.477,229.615 140.488 C 229.816 140.495,230.027 140.425,230.083 140.333 C 230.205 140.136,230.042 140.136,229.583 140.333 " stroke="none" fill="#9ddcd8" fill-rule="evenod"></path><path id="path3" d="M220.333 73.150 C 220.801 73.413,222.105 73.462,222.518 73.233 C 222.874 73.035,222.766 73.012,221.500 73.011 C 220.648 73.010,220.183 73.066,220.333 73.150 M218.042 101.083 C 218.044 101.450,218.078 101.580,218.118 101.373 C 218.158 101.166,218.156 100.866,218.115 100.706 C 218.073 100.547,218.040 100.717,218.042 101.083 M190.172 122.179 C 190.169 122.324,190.372 122.624,190.624 122.846 C 190.935 123.121,190.996 123.144,190.814 122.917 C 190.667 122.733,190.463 122.433,190.362 122.250 C 190.222 121.998,190.176 121.981,190.172 122.179 " stroke="none" fill="#5dbbc7" fill-rule="evenod"></path><path id="path4" d="M220.353 73.349 C 220.569 73.486,221.970 73.572,221.819 73.439 C 221.781 73.405,221.384 73.338,220.936 73.290 C 220.438 73.237,220.211 73.259,220.353 73.349 M230.514 74.726 C 230.552 74.759,230.846 74.834,231.167 74.892 C 231.577 74.968,231.676 74.951,231.500 74.836 C 231.274 74.688,230.349 74.585,230.514 74.726 M204.067 77.192 L 203.750 77.552 204.250 77.243 C 204.931 76.823,204.921 76.833,204.637 76.833 C 204.498 76.833,204.242 76.995,204.067 77.192 M245.083 83.833 C 245.441 84.200,245.772 84.500,245.818 84.500 C 245.863 84.500,245.608 84.200,245.250 83.833 C 244.892 83.467,244.562 83.167,244.516 83.167 C 244.470 83.167,244.725 83.467,245.083 83.833 M194.750 85.294 C 194.430 85.529,193.950 86.167,194.099 86.157 C 194.182 86.152,194.424 85.927,194.638 85.657 C 195.028 85.163,195.057 85.068,194.750 85.294 M191.423 89.598 C 191.022 90.209,191.199 90.263,191.642 89.665 C 191.844 89.391,191.941 89.167,191.857 89.167 C 191.774 89.167,191.578 89.361,191.423 89.598 M225.326 91.542 C 226.017 92.278,226.167 92.410,226.167 92.285 C 226.167 92.258,225.810 91.902,225.375 91.493 L 224.583 90.750 225.326 91.542 M188.076 97.696 C 188.010 97.909,187.881 98.131,187.791 98.189 C 187.700 98.247,187.658 98.391,187.697 98.509 C 187.737 98.627,187.902 98.442,188.065 98.098 C 188.228 97.754,188.325 97.436,188.279 97.391 C 188.234 97.345,188.143 97.483,188.076 97.696 M254.205 100.333 C 254.205 100.654,254.240 100.785,254.282 100.625 C 254.323 100.465,254.323 100.202,254.282 100.042 C 254.240 99.881,254.205 100.013,254.205 100.333 M224.218 101.917 C 224.219 102.467,224.250 102.672,224.287 102.372 C 224.325 102.072,224.324 101.622,224.286 101.372 C 224.248 101.122,224.217 101.367,224.218 101.917 M217.892 103.250 C 217.892 104.075,217.920 104.434,217.955 104.047 C 217.990 103.660,217.990 102.985,217.956 102.547 C 217.922 102.109,217.893 102.425,217.892 103.250 M254.604 103.167 C 254.657 103.579,254.774 103.992,254.862 104.083 C 255.025 104.251,254.930 103.711,254.643 102.833 C 254.553 102.557,254.540 102.670,254.604 103.167 M254.855 106.708 C 254.903 108.046,254.984 108.529,255.144 108.431 C 255.318 108.324,255.157 105.500,254.977 105.500 C 254.878 105.500,254.829 105.990,254.855 106.708 M255.385 106.583 C 255.386 107.133,255.417 107.338,255.454 107.039 C 255.491 106.739,255.490 106.289,255.452 106.039 C 255.414 105.788,255.384 106.033,255.385 106.583 M255.023 109.115 C 255.010 109.316,254.925 109.527,254.833 109.583 C 254.742 109.640,254.678 109.926,254.692 110.218 L 254.717 110.750 254.790 110.251 C 254.830 109.976,254.938 109.705,255.030 109.648 C 255.121 109.592,255.162 109.367,255.121 109.148 C 255.050 108.776,255.044 108.773,255.023 109.115 M254.205 113.667 C 254.205 113.987,254.240 114.119,254.282 113.958 C 254.323 113.798,254.323 113.535,254.282 113.375 C 254.240 113.215,254.205 113.346,254.205 113.667 M187.678 115.448 C 187.672 115.649,187.742 115.860,187.833 115.917 C 188.030 116.039,188.030 115.875,187.833 115.417 C 187.695 115.095,187.690 115.096,187.678 115.448 M252.375 120.042 C 252.196 120.531,252.200 120.552,252.422 120.260 C 252.634 119.980,252.759 119.500,252.620 119.500 C 252.594 119.500,252.484 119.744,252.375 120.042 M251.847 120.975 C 251.575 121.483,251.631 121.625,251.934 121.193 C 252.081 120.983,252.162 120.773,252.114 120.725 C 252.066 120.677,251.946 120.790,251.847 120.975 M189.698 120.936 C 189.853 120.983,190.015 121.185,190.059 121.385 C 190.125 121.691,190.134 121.683,190.111 121.335 C 190.092 121.053,189.976 120.909,189.750 120.886 C 189.510 120.862,189.496 120.876,189.698 120.936 M248.909 126.058 C 248.530 126.476,248.478 126.728,248.843 126.380 C 249.057 126.176,249.198 125.977,249.157 125.938 C 249.117 125.899,249.005 125.953,248.909 126.058 M195.083 128.333 C 195.226 128.608,195.379 128.833,195.425 128.833 C 195.471 128.833,195.392 128.608,195.250 128.333 C 195.108 128.058,194.954 127.833,194.908 127.833 C 194.862 127.833,194.941 128.058,195.083 128.333 M246.418 128.998 C 246.156 129.272,245.976 129.531,246.018 129.574 C 246.061 129.616,246.302 129.392,246.555 129.076 C 247.120 128.368,247.057 128.332,246.418 128.998 M195.996 129.328 C 196.190 129.601,196.434 129.876,196.538 129.940 C 196.642 130.004,196.517 129.782,196.260 129.445 C 195.703 128.715,195.493 128.622,195.996 129.328 M244.667 130.833 C 244.376 131.200,244.176 131.500,244.222 131.500 C 244.268 131.500,244.543 131.200,244.833 130.833 C 245.124 130.467,245.324 130.167,245.278 130.167 C 245.232 130.167,244.957 130.467,244.667 130.833 M242.578 132.750 C 241.849 133.438,241.302 134.000,241.362 134.000 C 241.496 134.000,244.121 131.509,243.993 131.504 C 243.944 131.502,243.307 132.063,242.578 132.750 M199.155 132.479 C 199.469 132.766,199.762 133.000,199.806 133.000 C 199.962 133.000,199.247 132.299,198.919 132.130 C 198.734 132.036,198.841 132.193,199.155 132.479 M240.625 134.262 C 240.002 134.600,240.040 134.741,240.667 134.417 C 240.942 134.274,241.167 134.123,241.167 134.079 C 241.167 133.972,241.149 133.978,240.625 134.262 M241.646 134.433 C 241.406 134.560,241.107 134.796,240.983 134.957 C 240.766 135.236,240.772 135.236,241.099 134.958 C 241.288 134.798,241.522 134.667,241.618 134.667 C 241.714 134.667,241.886 134.554,242.000 134.417 C 242.241 134.126,242.226 134.127,241.646 134.433 M202.052 134.738 C 202.251 134.961,202.444 135.111,202.483 135.072 C 202.573 134.983,201.991 134.333,201.820 134.333 C 201.750 134.333,201.854 134.515,202.052 134.738 M234.208 138.186 C 233.910 138.377,233.667 138.565,233.667 138.604 C 233.667 138.678,234.399 138.305,234.833 138.009 C 235.315 137.681,234.745 137.842,234.208 138.186 M230.852 139.180 C 230.450 139.259,230.078 139.367,230.025 139.420 C 229.914 139.531,231.220 139.339,231.833 139.154 C 232.421 138.977,231.803 138.993,230.852 139.180 M211.250 139.333 C 211.748 139.547,212.165 139.547,211.833 139.333 C 211.696 139.244,211.433 139.176,211.250 139.181 L 210.917 139.190 211.250 139.333 M215.181 140.227 C 215.219 140.259,215.475 140.337,215.750 140.398 C 216.115 140.480,216.183 140.464,216.000 140.341 C 215.775 140.189,215.013 140.082,215.181 140.227 M226.208 140.282 C 226.369 140.323,226.631 140.323,226.792 140.282 C 226.952 140.240,226.821 140.205,226.500 140.205 C 226.179 140.205,226.048 140.240,226.208 140.282 M221.167 141.000 L 219.250 141.100 221.083 141.122 C 222.092 141.134,223.067 141.079,223.250 141.000 C 223.433 140.921,223.471 140.866,223.333 140.878 C 223.196 140.890,222.221 140.945,221.167 141.000 " stroke="none" fill="#1790eb" fill-rule="evenod"></path></g></svg>
        </div>
    </div>
  </div>
</template>

<script>
import { mapGetters, mapActions } from 'vuex'
import PhoneTitle from './../PhoneTitle'
import Modal from '@/components/Modal/index.js'

export default {
  data () {
    return {
      ignoreControls: false,
      selectMessage: -1,
      display: '',
      phoneNumber: '',
      imgZoom: undefined,
      message: ''
    }
  },
  components: {
    PhoneTitle
  },
  methods: {
    ...mapActions(['setMessageRead', 'sendMessage', 'deleteMessage', 'startCall']),
    resetScroll () {
      this.$nextTick(() => {
        let elem = document.querySelector('#sms_list')
        elem.scrollTop = elem.scrollHeight
        this.selectMessage = -1
      })
    },
    scrollIntoViewIfNeeded () {
      this.$nextTick(() => {
        const elem = this.$el.querySelector('.select')
        if (elem !== null) {
          elem.scrollIntoViewIfNeeded()
        }
      })
    },
    quit () {
      // this.$router.push({path: '/messages'})
      this.$router.go(-1)
    },
    onUp: function () {
      if (this.ignoreControls === true) return
      if (this.selectMessage === -1) {
        this.selectMessage = this.messagesList.length - 1
      } else {
        this.selectMessage = this.selectMessage === 0 ? 0 : this.selectMessage - 1
      }
      this.scrollIntoViewIfNeeded()
    },
    onDown () {
      if (this.ignoreControls === true) return
      if (this.selectMessage === -1) {
        this.selectMessage = this.messagesList.length - 1
      } else {
        this.selectMessage = this.selectMessage === this.messagesList.length - 1 ? this.selectMessage : this.selectMessage + 1
      }
      this.scrollIntoViewIfNeeded()
    },
    onEnter () {
      if (this.ignoreControls === true) return
      if (this.selectMessage !== -1) {
        this.onActionMessage(this.messagesList[this.selectMessage])
      } else {
        this.$phoneAPI.getReponseText().then(data => {
          let message = data.text.trim()
          if (message !== '') {
            this.sendMessage({
              phoneNumber: this.phoneNumber,
              message
            })
          }
        })
      }
    },
    send () {
      const message = this.message.trim()
      if (message === '') return
      this.message = ''
      this.sendMessage({
        phoneNumber: this.phoneNumber,
        message
      })
    },
    isSMSImage (mess) {
      return /^https?:\/\/.*\.(png|jpg|jpeg|gif)/.test(mess.message)
    },
    async onActionMessage (message) {
      try {
        // let message = this.messagesList[this.selectMessage]
        let isGPS = /(-?\d+(\.\d+)?), (-?\d+(\.\d+)?)/.test(message.message)
        let hasNumber = /#([0-9]+)/.test(message.message)
        let isSMSImage = this.isSMSImage(message)
        let choix = [{
          id: 'delete',
          title: this.IntlString('APP_MESSAGE_DELETE'),
          icons: 'fa-trash'
        }, {
          id: -1,
          title: this.IntlString('CANCEL'),
          icons: 'fa-undo'
        }]
        if (isGPS === true) {
          choix = [{
            id: 'gps',
            title: this.IntlString('APP_MESSAGE_SET_GPS'),
            icons: 'fa-location-arrow'
          }, ...choix]
        }
        if (hasNumber === true) {
          const num = message.message.match(/#([0-9-]*)/)[1]
          choix = [{
            id: 'num',
            title: `${this.IntlString('APP_MESSAGE_MESS_NUMBER')} ${num}`,
            number: num,
            icons: 'fa-phone'
          }, ...choix]
        }
        if (isSMSImage === true) {
          choix = [{
            id: 'zoom',
            title: this.IntlString('APP_MESSAGE_ZOOM_IMG'),
            icons: 'fa-search'
          }, ...choix]
        }
        this.ignoreControls = true
        const data = await Modal.CreateModal({choix})
        if (data.id === 'delete') {
          this.deleteMessage({ id: message.id })
        } else if (data.id === 'gps') {
          let val = message.message.match(/(-?\d+(\.\d+)?), (-?\d+(\.\d+)?)/)
          this.$phoneAPI.setGPS(val[1], val[3])
        } else if (data.id === 'num') {
          this.$nextTick(() => {
            this.onSelectPhoneNumber(data.number)
          })
        } else if (data.id === 'zoom') {
          this.imgZoom = message.message
        }
      } catch (e) {
      } finally {
        this.ignoreControls = false
        this.selectMessage = -1
      }
    },
    async onSelectPhoneNumber (number) {
      try {
        this.ignoreControls = true
        let choix = [
          {
            id: 'sms',
            title: this.IntlString('APP_MESSAGE_MESS_SMS'),
            icons: 'fa-comment'
          },
          {
            id: 'call',
            title: this.IntlString('APP_MESSAGE_MESS_CALL'),
            icons: 'fa-phone'
          }
        ]
        // if (this.useMouse === true) {
        choix.push({
          id: 'copy',
          title: this.IntlString('APP_MESSAGE_MESS_COPY'),
          icons: 'fa-copy'
        })
        // }
        choix.push({
          id: -1,
          title: this.IntlString('CANCEL'),
          icons: 'fa-undo'
        })
        const data = await Modal.CreateModal({ choix })
        if (data.id === 'sms') {
          this.phoneNumber = number
          this.display = undefined
        } else if (data.id === 'call') {
          this.startCall({ numero: number })
        } else if (data.id === 'copy') {
          try {
            const $copyTextarea = this.$refs.copyTextarea
            $copyTextarea.value = number
            $copyTextarea.style.height = '20px'
            $copyTextarea.focus()
            $copyTextarea.select()
            await document.execCommand('copy')
            $copyTextarea.style.height = '0'
          } catch (error) {
          }
        }
      } catch (e) {
      } finally {
        this.ignoreControls = false
        this.selectMessage = -1
      }
    },
    onBackspace () {
      if (this.imgZoom !== undefined) {
        this.imgZoom = undefined
        return
      }
      if (this.ignoreControls === true) return
      if (this.useMouse === true && document.activeElement.tagName !== 'BODY') return
      if (this.selectMessage !== -1) {
        this.selectMessage = -1
      } else {
        this.quit()
      }
    },
    async showOptions () {
      try {
        this.ignoreControls = true
        let choix = [
          {id: 1, title: this.IntlString('APP_MESSAGE_SEND_GPS'), icons: 'fa-location-arrow'},
          {id: -1, title: this.IntlString('CANCEL'), icons: 'fa-undo'}
        ]
        if (this.enableTakePhoto) {
          choix = [
            {id: 1, title: this.IntlString('APP_MESSAGE_SEND_GPS'), icons: 'fa-location-arrow'},
            {id: 2, title: this.IntlString('APP_MESSAGE_SEND_PHOTO'), icons: 'fa-picture-o'},
            {id: -1, title: this.IntlString('CANCEL'), icons: 'fa-undo'}
          ]
        }
        const data = await Modal.CreateModal({ choix })
        if (data.id === 1) {
          this.sendMessage({
            phoneNumber: this.phoneNumber,
            message: '%pos%'
          })
        }
        if (data.id === 2) {
          const { url } = await this.$phoneAPI.takePhoto()
          if (url !== null && url !== undefined) {
            this.sendMessage({
              phoneNumber: this.phoneNumber,
              message: url
            })
          }
        }
        this.ignoreControls = false
      } catch (e) {
      } finally {
        this.ignoreControls = false
      }
    },
    onRight: function () {
      if (this.ignoreControls === true) return
      if (this.selectMessage === -1) {
        this.showOptions()
      }
    }
  },
  computed: {
    ...mapGetters(['IntlString', 'messages', 'contacts', 'useMouse', 'enableTakePhoto']),
    messagesList () {
      return this.messages.filter(e => e.transmitter === this.phoneNumber).sort((a, b) => a.time - b.time)
    },
    displayContact () {
      if (this.display !== undefined) {
        return this.display
      }
      const c = this.contacts.find(c => c.number === this.phoneNumber)
      if (c !== undefined) {
        return c.display
      }
      return this.phoneNumber
    },
    colorSmsOwner () {
      return [
        {
          backgroundColor: '#262628',
          color: '#E9E9EA'
        }, {}
      ]
    }
  },
  watch: {
    messagesList () {
      this.setMessageRead(this.phoneNumber)
      this.resetScroll()
    }
  },
  created () {
    this.display = this.$route.params.display
    this.phoneNumber = this.$route.params.number
    if (!this.useMouse) {
      this.$bus.$on('keyUpArrowDown', this.onDown)
      this.$bus.$on('keyUpArrowUp', this.onUp)
      this.$bus.$on('keyUpEnter', this.onEnter)
      this.$bus.$on('keyUpArrowRight', this.onRight)
    }
    this.$bus.$on('keyUpBackspace', this.onBackspace)
  },
  beforeDestroy () {
    this.$bus.$off('keyUpArrowDown', this.onDown)
    this.$bus.$off('keyUpArrowUp', this.onUp)
    this.$bus.$off('keyUpEnter', this.onEnter)
    this.$bus.$off('keyUpArrowRight', this.onRight)
    this.$bus.$off('keyUpBackspace', this.onBackspace)
  }
}
</script>

<style scoped>
.messages{
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(100% - 20px);
    background-color: rgb(0, 0, 0);    
}
#sms_contact{
    background-color: #4CAF50;
    color: white;
    height: 34px;
    line-height: 34px;
    padding-left: 5px;
}

#sms_list{
    height: calc(100% - 34px - 26px);
    overflow-y: auto;
    padding-bottom: 8px;
}

.sms{
  overflow: auto;
  zoom: 1;
}

.sms-img{
  width: 100%;
  height: auto;
}
.img-fullscreen {
  position: fixed;
  z-index: 999999;
  background-color: rgba(20, 20, 20, 0.8);
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}
.img-fullscreen img {
  display: flex;
  max-width: 90vw;
  max-height: 95vh;
}

.sms_me{
  float: right;
  background-color: #1D8BFF;
  color: white;
  padding: 5px 10px;
  max-width: 90%;
  margin-right: 5%;
  margin-top: 10px;
  border-radius: 20px;
  
}


.sms_other{
    background-color: #4CAF50;
    color:white;
    float: left;
    padding: 5px 10px;
    max-width: 90%;
    margin-left: 5%;
    margin-top: 10px;
}


.sms_time{
    display: block;
    font-size: 12px;
}

.sms_me .sms_time{
    color: #AAA;
}
.sms_other .sms_time{
    color: #555;
}
.messages{
  position: relative;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.sms.select .sms_message, .sms:hover .sms_message{
  background-color: rgb(151, 151, 151) !important;
  color: #d4d4d4 !important;
}


.sms.select .sms_message .sms_time, .sms:hover .sms_message .sms_time{
  background-color: inherit !important;
}

.sms_message{
  word-wrap: break-word;
  max-width: 80%;
  font-size: 24px;
}

#sms_write{
    height: 36px;
    margin: 10px;
    width: 380px;
    background-color: rgb(0, 0, 0);
    border-radius: 56px;
    color: white;
    border: 0.5px solid #29292A;
}
#sms_write input{
    height: 36px;
    border: none;
    outline: none;
    font-size: 18px;
    margin-left: 14px;
    padding: 12px 5px;
    background-color: rgba(236, 236, 241, 0);
    color: white;
}

.sms_send{
    float: right;
    margin-right: 10px;
}
.sms_send svg{
    margin-top: -133px;
    margin-right: -100px;
    width: 236px;
    height: 236px;
    fill: #0584FF;
}
.copyTextarea {
  height: 0;
  border: 0;
  padding: 0;
}
</style>
